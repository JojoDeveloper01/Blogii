---
import Layout from "@layouts/Layout.astro";
import Hero from "@components/Hero.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "@lib/consts";
import { getLangFromUrl } from "@i18n/utils";
import type { BlogData } from "@lib/types";
import { supabase } from "@lib/supabase";

const {
	data: { user },
} = await supabase.auth.getUser();

const lang = getLangFromUrl(Astro.url);
const isAuthorized = Boolean(user);

// Inicializar blogsData como array vazio
let blogsData: BlogData[] = [];

if (isAuthorized) {
    
}
else{
    const cookie = Astro.cookies.get("blogiis");
    try {
		blogsData = cookie ? JSON.parse(cookie.value) : [];
    } catch (error) {
        console.error("Erro ao ler o cookie 'blogiis'", error);
    }
}
---

<Layout title={SITE_TITLE} description={SITE_DESCRIPTION} {lang}>
	<main>
		<Hero {lang} {isAuthorized} {blogsData} />

		<p>
			Welcome to the official <a href="https://astro.build/">Astro</a>
			blog starter template. This template serves as a lightweight, minimally-styled
			starting point for anyone looking to build a personal website, blog,
			or portfolio with Astro.
		</p>
		<p>
			This template comes with a few integrations already configured in
			your
			<code>astro.config.mjs</code> file. You can customize your setup with
			<a href="https://astro.build/integrations">Astro Integrations</a> to
			add tools like Tailwind, React, or Vue to your project.
		</p>
		<p>Here are a few ideas on how to get started with the template:</p>
		<ul>
			<li>Edit this page in <code>src/pages/index.astro</code></li>
			<li>
				Edit the site header items in <code
					>src/components/Header.astro</code
				>
			</li>
			<li>
				Add your name to the footer in <code
					>src/components/Footer.astro</code
				>
			</li>
			<li>
				Check out the included blog posts in <code
					>src/content/blog/</code
				>
			</li>
			<li>
				Customize the blog post page layout in <code
					>src/layouts/BlogPost.astro</code
				>
			</li>
		</ul>
		<p>
			Have fun! If you get stuck, remember to <a
				href="https://docs.astro.build/"
				>read the docs
			</a> or <a href="https://astro.build/chat">join us on Discord</a> to
			ask questions.
		</p>
		<p>
			Looking for a blog template with a bit more personality? Check out <a
				href="https://github.com/Charca/astro-blog-template"
				>astro-blog-template
			</a> by <a href="https://twitter.com/Charca">Maxi Ferreira</a>.
		</p>
	</main>
</Layout>