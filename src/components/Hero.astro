---
import { sanitizeString } from "@lib/utils";
import { getCollection } from "astro:content";
import { TitleInput } from "./TitleInput";
import type { BlogData } from "@lib/types";

const blogsData: BlogData[] = await getCollection("blog");

//console.log("blogs: ", blogsData);

const { lang, isAuthorized } = Astro.props;
---

<section
    class="hero h-screen flex justify-center items-center relative overflow-hidden"
>
    <div transition:name="panel-before" class="panel panel-before"></div>
    <div transition:name="panel-after" class="panel panel-after"></div>
    <div class="panel-top w-screen absolute top-[-30%] h-36"></div>
    <div
        id="your-title"
        class="flex flex-col gap-8 items-center mx-4 text-center z-10"
    >
        <h1 class="max-[1000px]:text-[15vw]">
            Blog<span class="text-[--orange]">ii</span>
        </h1>
        <h2 class="max-w-[50vw] max-[900px]:text-[1em]">
            Qual será o título da sua próxima ideia?
        </h2>
        <TitleInput blogsData={data} {isAuthorized} />
        {
            blogsData.length !== 0 && (
                <div
                    id="blogsCreated"
                    class="w-3/4 p-4 bg-white dark:bg-[var(--gray)] rounded-lg shadow-lg max-h-64 overflow-y-auto"
                >
                    <h3 class="mb-4 text-lg font-bold text-orange-500">
                        Blogs Criados:
                    </h3>
                    <ul class="space-y-2">
                        {data.map((blog: BlogData) => (
                            <li class="flex items-center justify-center space-x-2">
                                <span class="text-orange-400">&rarr;</span>
                                <a
                                    href={`blog/${sanitizeString(blog.data.title, 1)}`}
                                    class="text-white dark:text-gray-900 hover:text-orange-300 transition-colors duration-200"
                                >
                                    {sanitizeString(blog.data.title)}``
                                </a>
                            </li>
                        ))}
                    </ul>
                </div>
            )
        }
    </div>
</section>

<style>
    .hero {
        position: relative;
        overflow: hidden;
    }

    .panel-before {
        left: -25%;
        transform: rotate(8deg);
    }

    .panel-after {
        right: -25%;
        transform: rotate(-8deg);
    }

    #conj-title {
        opacity: 1;
        transition: opacity 0.3s cubic-bezier(0.97, 0.77, 0, 0.26);
    }
</style>
